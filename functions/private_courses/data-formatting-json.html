<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•¸æ“šæ ¼å¼åŒ–ï¼šå¾ç‰©ä»¶åˆ° JSON | Vibe Coding</title>
    <link rel="stylesheet" href="../style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700&family=Noto+Sans+TC:wght@400;700&display=swap"
        rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
</head>

<body class="flex flex-col min-h-screen bg-slate-50 font-sans">

    <!-- Hero Section -->
    <header
        class="relative bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 text-white pt-24 pb-32 overflow-hidden">
        <div class="header-overlay absolute inset-0 bg-gradient-to-r from-purple-600 to-pink-600 opacity-90"></div>
        <div class="container mx-auto px-4 relative z-10 pt-20 pb-20 text-center text-white">
            <div
                class="badge-header bg-white/20 text-white border border-white/30 backdrop-blur-sm inline-block px-3 py-1 rounded-full text-xs font-bold mb-3 tracking-wide uppercase">
                Learning 2
            </div>
            <h1 class="text-4xl md:text-5xl font-extrabold mb-6 tracking-tight leading-tight">
                æ•¸æ“šæ ¼å¼åŒ–ï¼š<br><span class="text-transparent bg-clip-text bg-gradient-to-r from-pink-200 to-purple-200">å¾ç‰©ä»¶åˆ°
                    JSON</span>
            </h1>
            <p class="text-xl text-purple-100 max-w-2xl mx-auto leading-relaxed mb-10">
                ç‚ºä»€éº¼æˆ‘å€‘éœ€è¦ JSONï¼Ÿå­¸ç¿’å¦‚ä½•å°‡æ–æ¡¿åº§æ¨™èˆ‡æŒ‰éˆ•ç‹€æ…‹ï¼Œè½‰æ›ç‚º ESP32 èƒ½è½æ‡‚çš„é€šç”¨èªè¨€ã€‚
            </p>

            <div class="flex flex-wrap justify-center gap-4">
                <button onclick="playVideo()"
                    class="resource-btn bg-pink-500 hover:bg-pink-400 text-white px-6 py-3 rounded-full flex items-center gap-2 shadow-lg font-bold transition">
                    <span>â–¶ï¸</span> è§€çœ‹æ•™å­¸å½±ç‰‡
                </button>
                <button onclick="openDoc()"
                    class="resource-btn bg-white/10 hover:bg-white/20 border border-white/20 text-white px-6 py-3 rounded-full flex items-center gap-2 backdrop-blur-sm font-bold transition">
                    <span>ğŸ“„</span> é–±è®€èª²ç¨‹è¬›ç¾©
                </button>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8 flex-grow max-w-5xl">
        <!-- Old Header Removed -->

        <!-- 1. ç›´è¦ºå¯¦é©—å®¤ -->
        <div class="section-card bg-white rounded-2xl shadow-sm border border-slate-100 p-6 md:p-8 mb-8">
            <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-3">
                <div class="w-10 h-10 rounded-xl bg-pink-100 text-pink-600 flex items-center justify-center text-xl">ğŸ§ª
                </div>
                1. èª²å‰é«”é©—ï¼šç‚ºä»€éº¼æ˜¯ JSONï¼Ÿ
            </h2>
            <div class="grid md:grid-cols-2 gap-10">
                <div>
                    <p class="text-slate-600 mb-4 leading-relaxed">
                        æƒ³åƒä½ è¦å‚³é€ã€Œå‘å·¦è½‰ï¼Œé€Ÿåº¦ 100ã€çµ¦ç„¡äººè»Šã€‚å¦‚æœåªæ˜¯å–®ç´”æ‹¼æ¥å­—ä¸²ï¼Œæ¥æ”¶ç«¯æœƒå¾ˆé›£è§£æã€‚
                        JSON å› æ‡‰è€Œç”Ÿï¼Œå®ƒåƒæ˜¯ä¸€å€‹æ¨™æº–åŒ–çš„åŒ…è£¹ï¼Œè®“ç™¼é€ç«¯ (Web) èˆ‡æ¥æ”¶ç«¯ (ESP32) éƒ½èƒ½ç²¾æº–ç†è§£ã€‚
                    </p>
                    <div class="bg-slate-50 p-4 rounded-xl border border-slate-200 mb-4">
                        <h3 class="font-bold text-slate-700 mb-2 text-sm">â›” å¦‚æœç”¨å­—ä¸²æ‹¼æ¥...</h3>
                        <div class="font-mono text-sm text-slate-500 bg-white p-2 rounded border border-slate-200">
                            "L-100-MOVE" <span class="text-red-400">â† é †åºéŒ¯äº†å°±å®Œäº†ï¼</span>
                        </div>
                    </div>
                    <div class="bg-indigo-50 p-4 rounded-xl border border-indigo-100">
                        <h3 class="font-bold text-indigo-800 mb-2 text-sm">âœ… ä½¿ç”¨ JSON æ¨™æº–æ ¼å¼</h3>
                        <div class="font-mono text-sm text-indigo-600 bg-white p-2 rounded border border-indigo-100">
                            {"dir": "L", "speed": 100} <span class="text-green-600 text-xs ml-2">â† æ¸…æ™°æ˜ç¢º</span>
                        </div>
                    </div>
                </div>

                <!-- Interactive: JSON Handwriting -->
                <div class="bg-slate-800 rounded-xl p-5 text-white shadow-lg relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-4 opacity-10 text-6xl">ğŸ“</div>
                    <h3 class="font-bold text-emerald-400 mb-1 flex justify-between items-center">
                        <span>ç·šä¸Šä»»å‹™ï¼šæ‰‹å¯« JSON</span>
                        <span id="lab-score"
                            class="text-xs bg-emerald-900 text-emerald-300 px-2 py-1 rounded">0/1</span>
                    </h3>
                    <p class="text-xs text-slate-400 mb-4">è«‹è§€å¯Ÿç›®æ¨™ç‰©ä»¶ï¼Œæ‰‹å¯«å‡ºæ­£ç¢ºçš„ JSON å­—ä¸² (æ³¨æ„é›™å¼•è™Ÿï¼)</p>

                    <div class="mb-3">
                        <div class="text-xs text-slate-500 mb-1">ç›®æ¨™ç‰©ä»¶ (Object):</div>
                        <div class="font-mono text-sm text-yellow-300 bg-slate-900 p-2 rounded border border-slate-700">
                            { x: 50, y: -20, cmd: "LOCK" }
                        </div>
                    </div>

                    <div>
                        <div class="text-xs text-slate-500 mb-1">ä½ çš„ JSON (String):</div>
                        <input type="text" id="json-input" placeholder='{"x": 50...}'
                            class="w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm font-mono text-white placeholder-slate-500 focus:outline-none focus:border-pink-500 transition">
                        <div id="json-feedback" class="h-6 mt-1 text-xs font-bold transition-all duration-300"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. æ ¸å¿ƒåŸç† -->
        <div class="section-card bg-white rounded-2xl shadow-sm border border-slate-100 p-6 md:p-8 mb-8">
            <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-3">
                <div class="w-10 h-10 rounded-xl bg-blue-100 text-blue-600 flex items-center justify-center text-xl">ğŸ§ 
                </div>
                2. æ ¸å¿ƒåŸç†ï¼šJSON.stringify èˆ‡ ESP32 è§£æ
            </h2>

            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <!-- JS Side -->
                <div>
                    <h3 class="text-lg font-bold text-slate-700 mb-3 border-l-4 border-yellow-400 pl-3">JavaScript ç«¯ï¼šåºåˆ—åŒ–
                    </h3>
                    <p class="text-slate-600 text-sm mb-4">
                        <code class="bg-slate-100 px-1 rounded text-pink-600 font-mono">JSON.stringify()</code>
                        æ˜¯æˆ‘å€‘æœ€å¼·å¤§çš„åŠ©æ‰‹ã€‚ä½†è¦æ³¨æ„ï¼Œå®ƒæœƒ<b>éæ¿¾</b>æ‰å®ƒä¸èªè­˜çš„æ±è¥¿ï¼
                    </p>

                    <div class="bg-slate-900 rounded-lg overflow-hidden text-sm font-mono leading-relaxed shadow-lg">
                        <div
                            class="bg-slate-800 px-4 py-2 text-slate-400 text-xs border-b border-slate-700 flex justify-between">
                            <span>console.js</span>
                            <span>ğŸ”´ Live Demo</span>
                        </div>
                        <div class="p-4">
                            <div class="text-purple-400">const</div>
                            <div class="text-blue-300 inline">data</div> = {<br>
                            &nbsp;&nbsp;speed: <span class="text-orange-400">100</span>,<br>
                            &nbsp;&nbsp;func: <span class="text-purple-400">() => {}</span>, <span
                                class="text-slate-500">// ğŸ™ˆ æœƒæ¶ˆå¤±</span><br>
                            &nbsp;&nbsp;val: <span class="text-purple-400">undefined</span> <span
                                class="text-slate-500">// ğŸ™ˆ æœƒæ¶ˆå¤±</span><br>
                            };<br><br>
                            <div class="text-yellow-300">JSON.stringify(data)</div><br>
                            <span class="text-green-400">â†³ "{"speed":100}"</span>
                        </div>
                    </div>
                </div>

                <!-- ESP32 Side -->
                <div>
                    <h3 class="text-lg font-bold text-slate-700 mb-3 border-l-4 border-blue-400 pl-3">ESP32
                        ç«¯ï¼šArduinoJson</h3>
                    <p class="text-slate-600 text-sm mb-4">
                        å¾®æ§åˆ¶å™¨æ²’æœ‰ç„¡é™çš„è¨˜æ†¶é«”ã€‚ä½¿ç”¨ <code
                            class="bg-slate-100 px-1 rounded text-blue-600 font-mono">StaticJsonDocument</code>
                        ä¾†é å…ˆé…ç½®å›ºå®šçš„è¨˜æ†¶é«”ç©ºé–“ï¼Œé¿å…è¨˜æ†¶é«”ç¢ç‰‡åŒ–ã€‚
                    </p>

                    <div class="bg-blue-50 rounded-xl p-4 border border-blue-100 relative">
                        <div class="absolute -top-3 left-6 px-2 bg-blue-100 text-blue-700 text-xs font-bold rounded">C++
                            / Arduino</div>
                        <div class="mt-2 space-y-3">
                            <div class="flex items-center gap-2 text-sm text-slate-700">
                                <span
                                    class="p-1.5 bg-white border border-slate-200 rounded font-mono text-xs shadow-sm">String
                                    input</span>
                                <span class="text-slate-400">â”</span>
                                <span class="font-mono text-xs text-orange-600">"{\"cmd\":\"move\"}"</span>
                            </div>
                            <div class="flex items-center gap-2 text-sm text-slate-700">
                                <span
                                    class="p-1.5 bg-white border border-slate-200 rounded font-mono text-xs shadow-sm">Deserialization</span>
                                <span class="text-slate-400">â”</span>
                                <div class="bg-slate-800 text-white text-xs p-2 rounded font-mono w-full">
                                    StaticJsonDocument&lt;200&gt; doc;<br>
                                    deserializeJson(doc, input);<br>
                                    <span class="text-purple-300">const char*</span> cmd = doc["cmd"];
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-yellow-50 p-4 rounded-xl border border-yellow-100">
                <h4 class="font-bold text-yellow-800 text-sm flex items-center gap-2 mb-2">
                    <span>ğŸ’¡ key-Value è¨­è¨ˆæ€ç¶­</span>
                </h4>
                <p class="text-slate-700 text-sm">
                    ç‚ºä»€éº¼ä¸ç›´æ¥å‚³é€ "å‰é€²"ï¼Ÿå› ç‚ºä¸­æ–‡ç·¨ç¢¼è¤‡é›œä¸”ä½”ç”¨é »å¯¬ã€‚ä½¿ç”¨
                    <code
                        class="bg-white px-1 border rounded text-slate-600 font-mono">{"cmd": "move", "val": 255}</code>
                    èƒ½å…¼é¡§<b>äººé¡å¯è®€æ€§</b>èˆ‡<b>æ©Ÿå™¨è§£ææ•ˆç‡</b>ã€‚
                </p>
            </div>
        </div>

        <!-- 3. å¯¦æˆ°æŒ‘æˆ° -->
        <div class="section-card bg-white rounded-2xl shadow-sm border border-slate-100 p-6 md:p-8">
            <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-3">
                <div
                    class="w-10 h-10 rounded-xl bg-purple-100 text-purple-600 flex items-center justify-center text-xl">
                    ğŸš€</div>
                3. å¯¦æˆ°æŒ‘æˆ°ï¼šå°åŒ…ç˜¦èº«èˆ‡å‹•æ…‹çµ„åˆ
            </h2>

            <div class="mb-6">
                <div class="flex gap-2 border-b border-slate-200" id="challenge-tabs">
                    <button
                        class="px-4 py-2 text-sm font-bold text-purple-600 border-b-2 border-purple-600 focus:outline-none"
                        data-tab="c1">
                        æŒ‘æˆ° 1: åŸºç¤å°è£
                    </button>
                    <button
                        class="px-4 py-2 text-sm font-medium text-slate-500 hover:text-purple-600 focus:outline-none"
                        data-tab="c2">
                        æŒ‘æˆ° 2: å°åŒ…ç˜¦èº«
                    </button>
                    <button
                        class="px-4 py-2 text-sm font-medium text-slate-500 hover:text-purple-600 focus:outline-none"
                        data-tab="c3">
                        æŒ‘æˆ° 3: ç‹€æ…‹æ©Ÿçµ„åˆ
                    </button>
                </div>
            </div>

            <!-- Challenge 1 -->
            <div id="content-c1" class="challenge-content">
                <p class="text-slate-600 mb-4 text-sm">
                    <b>ç›®æ¨™ï¼š</b> æ’°å¯«ä¸€å€‹å‡½å¼ <code class="font-mono text-pink-600">createPacket(id)</code>ï¼Œ
                    æ¥æ”¶æŒ‰éˆ• IDï¼Œå›å‚³ä¸€å€‹åŒ…å« <code class="font-mono">timestamp</code> (ç•¶ä¸‹æ™‚é–“æˆ³è¨˜) çš„ JSON å­—ä¸²ã€‚
                </p>
                <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm shadow-inner relative group">
                    <textarea id="code-c1"
                        class="w-full h-32 bg-transparent text-slate-300 focus:outline-none resize-none"
                        spellcheck="false">
function createPacket(btnId) {
    const data = {
        // åœ¨æ­¤å¯¦ä½œç‰©ä»¶å…§å®¹
        
    };
    return JSON.stringify(data);
}</textarea>
                    <button onclick="checkC1()"
                        class="absolute bottom-4 right-4 bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-xs font-bold shadow transition">
                        æäº¤åŸ·è¡Œ â–¶
                    </button>
                </div>
                <div id="result-c1" class="mt-2 text-sm font-mono h-6 transition-all transform"></div>
            </div>

            <!-- Challenge 2 -->
            <div id="content-c2" class="challenge-content hidden">
                <p class="text-slate-600 mb-4 text-sm">
                    <b>ç›®æ¨™ï¼š</b> åŸå§‹å°åŒ…å¤ªå¤§äº†ï¼è«‹å°‡ Key Name ç°¡åŒ–ä»¥æ¸›å°‘å­—å…ƒæ•¸ã€‚<br>
                    <span class="text-xs text-slate-400">è¦å‰‡ï¼šcommand -> c, velocity -> v</span>
                </p>
                <div class="flex items-center gap-4 mb-4">
                    <div class="flex-1 bg-red-50 p-3 rounded border border-red-100 opacity-60">
                        <div class="text-xs text-red-500 font-bold mb-1">åŸå§‹ (Original)</div>
                        <div class="font-mono text-xs text-slate-600">{"command":"move_forward","velocity":255}</div>
                        <div class="text-xs text-slate-400 mt-1">Length: 40</div>
                    </div>
                    <div class="text-slate-300">â¡</div>
                    <div class="flex-1 bg-green-50 p-3 rounded border border-green-100">
                        <div class="text-xs text-green-600 font-bold mb-1">ç›®æ¨™ (Optimized)</div>
                        <div class="font-mono text-xs text-slate-600">{"c":"f","v":255}</div>
                        <div class="text-xs text-slate-400 mt-1">Length: 15 (ç¯€çœ ~60%!)</div>
                    </div>
                </div>
                <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm shadow-inner relative">
                    <textarea id="code-c2"
                        class="w-full h-24 bg-transparent text-slate-300 focus:outline-none resize-none"
                        spellcheck="false">
const packet = { 
    c: "f", 
    v: 255 
};
return JSON.stringify(packet);</textarea>
                    <button onclick="checkC2()"
                        class="absolute bottom-4 right-4 bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-xs font-bold shadow transition">
                        è¨ˆç®—å¤§å° â–¶
                    </button>
                </div>
                <div id="result-c2" class="mt-2 text-sm font-mono h-6 transition-all text-emerald-600 font-bold"></div>
            </div>

            <!-- Challenge 3 -->
            <div id="content-c3" class="challenge-content hidden">
                <p class="text-slate-600 mb-4 text-sm">
                    <b>ç›®æ¨™ï¼š</b> å¯¦ä½œå·¢ç‹€ç‰©ä»¶ã€‚åŒæ™‚åŒ…å«æ–æ¡¿åº§æ¨™ (joy) èˆ‡æŒ‰éˆ•ç‹€æ…‹ (btn)ã€‚
                </p>
                <div class="bg-slate-50 p-3 border border-slate-200 rounded text-xs font-mono text-slate-500 mb-3">
                    Ref format: {"joy":{"x":10,"y":-5},"btn":{"a":1}}
                </div>
                <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm shadow-inner relative">
                    <textarea id="code-c3"
                        class="w-full h-32 bg-transparent text-slate-300 focus:outline-none resize-none"
                        spellcheck="false">
const complexData = {
    // å¯¦ä½œ joy (x:10, y:-5) å’Œ btn (a:1)
    
};
return JSON.stringify(complexData);</textarea>
                    <button onclick="checkC3()"
                        class="absolute bottom-4 right-4 bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-xs font-bold shadow transition">
                        é©—è­‰çµæ§‹ â–¶
                    </button>
                </div>
                <div id="result-c3" class="mt-2 text-sm font-mono h-6 transition-all text-emerald-600 font-bold"></div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-slate-800 text-slate-400 py-8 mt-12">
        <div class="container mx-auto px-4 text-center">
            <div class="font-bold text-xl text-white mb-2">ğŸš€ Vibe Coding</div>
            <p class="text-sm">&copy; 2025 Vibe Coding. All rights reserved.</p>
        </div>
    </footer>

    <!-- Fullscreen Media Overlay -->
    <div id="media-overlay" class="fixed inset-0 bg-black z-50 hidden flex flex-col overflow-hidden">
        <div id="doc-wrapper" class="hidden flex-grow w-full relative overflow-auto bg-gray-200 flex justify-center">
            <iframe id="doc-frame" class="border-0 bg-white shadow-2xl origin-top"
                style="width: 850px; height: 100%; transition: transform 0.2s ease;" src="">
            </iframe>
        </div>
        <div id="video-wrapper" class="hidden flex-grow w-full bg-black flex justify-center items-center">
            <iframe id="video-frame" class="w-full h-full" src="" title="Course Video" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                allowfullscreen>
            </iframe>
        </div>
    </div>

    <script>
        // --- Standard Media Overlay Logic ---
        const overlay = document.getElementById('media-overlay');
        const docWrapper = document.getElementById('doc-wrapper');
        const videoWrapper = document.getElementById('video-wrapper');
        let currentMode = null;
        let currentScale = 1.0;
        const BASE_DOC_WIDTH = 850;

        const RESOURCES = {
            youtube: "https://www.youtube.com/embed/KnuXXUo87f0",
            doc: "https://docs.google.com/document/d/e/2PACX-1vSVkD7iQ2vDjZNg6IzhSnvWfRBNC2T4brsYjTaQ42juKnTAuF4dsts06YoU7nW2Vc5M0BwczuQURKoG/pub?embedded=true"
        };

        function openDoc() {
            openModal('doc');
        }

        function playVideo() {
            openModal('youtube');
        }

        function openModal(type) {
            currentMode = type;
            docWrapper.classList.add('hidden');
            videoWrapper.classList.add('hidden');
            overlay.classList.remove('hidden');
            document.body.style.overflow = 'hidden';

            if (type === 'doc') {
                docWrapper.classList.remove('hidden');
                document.getElementById('doc-frame').src = RESOURCES.doc;
                setTimeout(autoFitZoom, 100);
            } else if (type === 'youtube') {
                videoWrapper.classList.remove('hidden');
                document.getElementById('video-frame').src = RESOURCES.youtube;
            }
            if (document.documentElement.requestFullscreen) {
                document.documentElement.requestFullscreen().catch(err => console.log(err));
            }
        }

        function closeModal() {
            overlay.classList.add('hidden');
            document.body.style.overflow = '';
            document.getElementById('video-frame').src = "";
            document.getElementById('doc-frame').src = "";
            if (document.fullscreenElement && document.exitFullscreen) {
                document.exitFullscreen().catch(err => console.log(err));
            }
            currentMode = null;
        }

        function autoFitZoom() {
            if (currentMode !== 'doc') return;
            const availableWidth = docWrapper.clientWidth;
            let scale = (availableWidth - 20) / BASE_DOC_WIDTH;
            if (scale < 0.5) scale = 0.5;
            applyZoom(scale);
        }

        function applyZoom(scale) {
            currentScale = scale;
            const iframe = document.getElementById('doc-frame');
            iframe.style.transform = `scale(${scale})`;
            iframe.style.height = `${100 / scale}%`;
            iframe.style.marginBottom = `${-(1 - scale) * 100}%`;
        }

        window.addEventListener('resize', () => {
            if (currentMode === 'doc' && !overlay.classList.contains('hidden')) {
                autoFitZoom();
            }
        });

        document.addEventListener('keydown', function (event) {
            if (event.key === "Escape") closeModal();
        });
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement && !overlay.classList.contains('hidden')) closeModal();
        });

        // --- Lab 1: Interactive JSON Handwriting ---
        const jsonInput = document.getElementById('json-input');
        const jsonFeedback = document.getElementById('json-feedback');
        const labScore = document.getElementById('lab-score');

        jsonInput.addEventListener('input', (e) => {
            const val = e.target.value.trim();
            try {
                // Try to parse
                const obj = JSON.parse(val);

                // Check if specific keys exist to ensure they aren't just parsing empty {}
                if (obj.x === 50 && obj.y === -20 && obj.cmd === "LOCK") {
                    jsonFeedback.innerHTML = "<span class='text-emerald-500'>âœ… å®Œç¾ï¼æ ¼å¼æ­£ç¢ºä¸”æ•¸å€¼å»åˆã€‚</span>";
                    jsonInput.classList.remove('border-red-500', 'border-slate-600');
                    jsonInput.classList.add('border-emerald-500');
                    labScore.textContent = "1/1";
                    labScore.classList.add('bg-emerald-500', 'text-white');
                } else {
                    jsonFeedback.innerHTML = "<span class='text-yellow-500'>âš ï¸ JSON æ ¼å¼æ­£ç¢ºï¼Œä½†æ•¸å€¼ä¸ç¬¦åˆç›®æ¨™ç‰©ä»¶ã€‚</span>";
                    jsonInput.classList.remove('border-red-500', 'border-emerald-500');
                    jsonInput.classList.add('border-yellow-500');
                }
            } catch (err) {
                // Check common mistakes
                if (val.includes("{x:") || val.includes("x:")) {
                    jsonFeedback.innerHTML = "<span class='text-red-400'>âŒ éŒ¯èª¤ï¼šKey å¿…é ˆç”¨é›™å¼•è™ŸåŒ…èµ·ä¾†ï¼Œä¾‹å¦‚ \"x\"</span>";
                } else if (val.includes("'")) {
                    jsonFeedback.innerHTML = "<span class='text-red-400'>âŒ éŒ¯èª¤ï¼šJSON å¿…é ˆä½¿ç”¨é›™å¼•è™Ÿ \"ï¼Œä¸èƒ½ç”¨å–®å¼•è™Ÿ '</span>";
                } else {
                    jsonFeedback.innerHTML = "<span class='text-red-400'>âŒ èªæ³•éŒ¯èª¤</span>";
                }
                jsonInput.classList.add('border-red-500');
                jsonInput.classList.remove('border-emerald-500', 'border-yellow-500');
                labScore.textContent = "0/1";
            }
        });

        // --- Tabs Logic ---
        const tabs = document.querySelectorAll('[data-tab]');
        const contents = document.querySelectorAll('.challenge-content');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active classes
                tabs.forEach(t => {
                    t.classList.remove('text-purple-600', 'border-b-2', 'border-purple-600', 'font-bold');
                    t.classList.add('text-slate-500', 'font-medium');
                });
                contents.forEach(c => c.classList.add('hidden'));

                // Add active class
                tab.classList.add('text-purple-600', 'border-b-2', 'border-purple-600', 'font-bold');
                tab.classList.remove('text-slate-500', 'font-medium');

                // Show content
                const targetId = tab.getAttribute('data-tab');
                document.getElementById('content-' + targetId).classList.remove('hidden');
            });
        });

        // --- Challenge Functions ---
        function checkC1() {
            const code = document.getElementById('code-c1').value;
            const resFunc = new Function('id', code);
            const resultDiv = document.getElementById('result-c1');

            try {
                const jsonStr = resFunc("btn_A");
                const obj = JSON.parse(jsonStr);

                if (obj.timestamp || obj.ts || obj.time) {
                    resultDiv.innerHTML = `<span class="text-emerald-500">âœ… æˆåŠŸï¼Output: ${jsonStr.substring(0, 40)}...</span>`;
                } else {
                    resultDiv.innerHTML = `<span class="text-yellow-600">âš ï¸ JSON æ ¼å¼æ­£ç¢ºï¼Œä½†åœ¨ç‰©ä»¶ä¸­æ‰¾ä¸åˆ° timestamp æˆ– time å±¬æ€§ã€‚</span>`;
                }
            } catch (e) {
                resultDiv.innerHTML = `<span class="text-red-500">âŒ éŒ¯èª¤: ${e.message}</span>`;
            }
        }

        function checkC2() {
            const code = document.getElementById('code-c2').value;
            const resFunc = new Function(code);
            const resultDiv = document.getElementById('result-c2');

            try {
                const jsonStr = resFunc();
                const obj = JSON.parse(jsonStr);
                const len = jsonStr.length;

                if (obj.c === "f" && obj.v === 255) {
                    if (len <= 20) {
                        resultDiv.innerHTML = `âœ… å®Œç¾ï¼é•·åº¦åƒ… ${len} bytesã€‚å„ªåŒ–æˆåŠŸã€‚`;
                    } else {
                        resultDiv.innerHTML = `âš ï¸ æ ¼å¼æ­£ç¢ºï¼Œä½†é•·åº¦ (${len}) ä¼¼ä¹é‚„å¯ä»¥æ›´çŸ­ï¼Ÿæª¢æŸ¥æ˜¯å¦æœ‰é¡å¤–ç©ºç™½ã€‚`;
                    }
                } else {
                    resultDiv.innerHTML = `<span class="text-red-500">âŒ æ•¸å€¼æˆ– Key ä¸ç¬¦åˆ c='f', v=255 çš„è¦æ±‚ã€‚</span>`;
                }
            } catch (e) {
                resultDiv.innerHTML = `<span class="text-red-500">âŒ éŒ¯èª¤: ${e.message}</span>`;
            }
        }

        function checkC3() {
            const code = document.getElementById('code-c3').value;
            const resFunc = new Function(code);
            const resultDiv = document.getElementById('result-c3');

            try {
                const jsonStr = resFunc();
                const obj = JSON.parse(jsonStr);

                if (obj.joy && obj.joy.x === 10 && obj.joy.y === -5 && obj.btn && obj.btn.a === 1) {
                    resultDiv.innerHTML = `âœ… çµæ§‹æ­£ç¢ºï¼é€™å°±æ˜¯å·¢ç‹€ç‰©ä»¶çš„å¨åŠ›ã€‚`;
                } else {
                    resultDiv.innerHTML = `<span class="text-red-500">âŒ çµæ§‹éŒ¯èª¤ã€‚è«‹ç¢ºä¿ joy:{x:10, y:-5} ä¸” btn:{a:1}</span>`;
                }
            } catch (e) {
                resultDiv.innerHTML = `<span class="text-red-500">âŒ éŒ¯èª¤: ${e.message}</span>`;
            }
        }
    </script>
</body>

</html>